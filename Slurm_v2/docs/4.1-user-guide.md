# Phase 4, Step 1: User Quickstart Guide

* **File:** `4.1-user-guide.md`
* **Date:** December 18, 2025
* **Target Audience:** Physics Students & Researchers
* **Goal:** A simple reference for logging in, managing files, and running simulations.

---

## 1. Accessing the Cluster

How you connect depends on your physical location.

### Scenario A: Inside the Lab (Behind EAL Firewall)

If you are physically in the lab or connected to the specific EAL subnet:

* **Web Portal:** [https://10.0.0.91](https://10.0.0.91)
  * *Note:* Accept the "Security Warning" for the self-signed certificate.
* **SSH:**

    ssh username@10.0.0.91

### Scenario B: Campus Network (Dorms/Library/Off-Site)

The cluster is on a private network. You must connect via the **Jump Host** (`oualnet.phy.ohio.edu`).

#### 1. Configure SSH (One-Time Setup)

Edit your local SSH config file (`~/.ssh/config` on Mac/Linux, or `%USERPROFILE%\.ssh\config` on Windows) and add the following block. This allows you to type `ssh node01` and automatically "jump" through the gateway.

    # Jump Host (Gateway)
    Host jump
        HostName oualnet.phy.ohio.edu
        User your_username
        # IdentityFile ~/.ssh/id_ed25519_lab  <-- Uncomment if you use a specific key

    # The Cluster Head Node
    Host node01
        HostName 10.0.0.91
        User your_username
        ProxyJump jump
        ForwardX11 yes
        ForwardX11Trusted yes

#### 2. Connect

* **Terminal:** Simply type:

    ssh node01

* **Web Portal:** You cannot access the web portal directly from campus without setting up an SSH Tunnel or SOCKS proxy. For now, use the terminal.

---

## 2. Using Open OnDemand (The Web Portal)

Open OnDemand is a **Dashboard**, not just a terminal. It provides a graphical menu to manage your workflow.

1. **Login:** Use your standard lab credentials.
2. **Files App:** Click **Files > Home Directory** to upload/download scripts and data via the browser (like Dropbox).
3. **Active Jobs:** Click **Jobs > Active Jobs** to monitor the progress of your Geant4/Talys simulations.
4. **The Shell (IMPORTANT):**
    To run the commands listed in **Section 4**, you need a terminal.
    * Click **Clusters > >_ Node 01 Shell Access**.
    * This opens a black terminal window in your browser.

---

## 3. Where is my stuff? (Storage)

The cluster uses a **Shared Filesystem**.

* **Path:** `/home/your_username`
* **Behavior:** Files you save here are visible on **ALL** nodes (Head Node and Compute Nodes).
* **Quota:** Please monitor your disk usage. Move large finished datasets to the archive storage.

---

## 4. Running Software (The "Easy Buttons")

The following commands can be run in your **Terminal** (via SSH or the Open OnDemand Shell).

### Interactive Tools (Head Node)

These run immediately on the login node. Use these for quick analysis, not heavy simulation.

* **CERN ROOT:**

    root -b

  * *Tip:* If you connected via SSH with X11 forwarding, typing `new TBrowser()` inside ROOT will open the GUI on your laptop.

* **MVME Conversion:**

    mvme2xy run1024.mvme

### Submitting Jobs (Compute Nodes)

**Do NOT** run heavy simulations (Geant4/Talys) on the Head Node. **Use these wrappers** to send work to the compute cluster.

* **Talys:**

    Usage: sub_talys <input_file> [optional_job_name]

    sub_talys gold.inp my_gold_run

* **Geant4:**

    Usage: sub_geant4 <simulation_executable> <macro_file>

    sub_geant4 ./exampleB1 run1.mac

* **Check Status:**

    squeue

---

## 5. Compiling Your Code

You cannot compile Geant4 code directly on the login node environment. You must use the build wrapper, which loads the necessary physics libraries.

1. Navigate to your source/build directory:

    cd ~/my_geant4_project/build

2. Run the build helper:

    lab-build

    *This enters the container, runs `cmake` and `make`, and exits.*

---

## 6. Troubleshooting

* **"Permission Denied" / "Command not found":** Ensure you are in your `/home` directory. Try logging out and back in.
* **X11/Graphics not showing:**
  * **Windows:** Ensure VcXsrv is running.
  * **Mac:** Ensure XQuartz is running.
  * **SSH:** Did you use `ForwardX11Trusted yes` in your config?
* **Job fails immediately:** Check the error log (e.g., `slurm-1234.out` or `talys_job.err`) created in your folder.
